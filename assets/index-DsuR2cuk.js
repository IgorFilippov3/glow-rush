(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();class g{canvas;context;dpi;constructor(t){this.canvas=t,this.context=this.canvas.getContext("2d"),this.dpi=Math.round(window.devicePixelRatio||1),this.fitToParent(),new ResizeObserver(()=>this.resize()).observe(this.canvas)}getWidth(){return this.canvas.width/this.dpi}getHeight(){return this.canvas.height/this.dpi}resize(){const{clientWidth:t,clientHeight:e}=this.canvas;this.canvas.width=Math.max(640,t)*this.dpi,this.canvas.height=Math.max(420,e)*this.dpi,this.context.setTransform(this.dpi,0,0,this.dpi,0,0)}fitToParent(){this.canvas.style.width="100%",this.canvas.style.height="100%",this.resize()}}function y(r,t,e,a){const s=r-e,i=t-a;return s*s+i*i}function h(r,t){return Math.random()*(t-r)+r}class x{targets=[];hazards=[];particles=[];canvasWidth;canvasHeight;constructor(t,e){this.canvasWidth=t,this.canvasHeight=e}spawnTarget(){this.targets.push({x:h(30,this.canvasWidth-30),y:h(30,this.canvasHeight-30),r:10,color:"#f97316"})}spawnHazard(){const t=h(6,10),e=h(1.2,2.2),a=Math.random()<.5?"x":"y";let s,i,n,l;a==="x"?(s=Math.random()<.5?-20:this.canvasWidth+20,i=h(20,this.canvasHeight-20),n=(s<0?1:-1)*e,l=h(-.4,.4)):(i=Math.random()<.5?-20:this.canvasHeight+20,s=h(20,this.canvasWidth-20),l=(i<0?1:-1)*e,n=h(-.4,.4)),this.hazards.push({x:s,y:i,r:t,vx:n,vy:l,color:"#ef4444"})}updateHazards(){for(let t=this.hazards.length-1;t>=0;t--){const e=this.hazards[t];e.x+=e.vx,e.y+=e.vy,(e.x<-40||e.x>this.canvasWidth+40||e.y<-40||e.y>this.canvasHeight+40)&&this.hazards.splice(t,1)}}updateParticles(t){for(let e=this.particles.length-1;e>=0;e--){const a=this.particles[e];a.x+=a.vx,a.y+=a.vy,a.life-=t*.003,a.life<=0&&this.particles.splice(e,1)}}boom(t,e){for(let a=0;a<24;a++)this.particles.push({x:t,y:e,vx:Math.cos(a)*h(1,3),vy:Math.sin(a)*h(1,3),r:h(1,3),life:1})}checkTargetCollisions(t){for(let e=this.targets.length-1;e>=0;e--){const a=this.targets[e];if(y(t.x,t.y,a.x,a.y)<(t.r+a.r)**2)return this.targets.splice(e,1),!0}return!1}checkHazardCollisions(t){for(const e of this.hazards)if(y(t.x,t.y,e.x,e.y)<(t.r+e.r)**2)return!0;return!1}}class f{keys=new Set;dashCallback;constructor(){this.setupEventListeners()}setDashCallback(t){this.dashCallback=t}isKeyPressed(t){return this.keys.has(t.toLowerCase())}getMovementInput(){const t=(this.isKeyPressed("arrowright")||this.isKeyPressed("d")?1:0)-(this.isKeyPressed("arrowleft")||this.isKeyPressed("a")?1:0),e=(this.isKeyPressed("arrowdown")||this.isKeyPressed("s")?1:0)-(this.isKeyPressed("arrowup")||this.isKeyPressed("w")?1:0);return{ax:t,ay:e}}setupEventListeners(){window.addEventListener("keydown",t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," ","Spacebar","w","a","s","d"].includes(t.key)&&t.preventDefault(),this.keys.add(t.key.toLowerCase()),(t.key===" "||t.code==="Space")&&this.dashCallback?.()}),window.addEventListener("keyup",t=>{this.keys.delete(t.key.toLowerCase())})}}class M{player;initialData;constructor(t){this.player=t,this.initialData=Object.assign({},t)}tryDash(t){const e=performance.now();if(e-this.player.lastDashAt<this.player.dashCooldownMs)return;let a=this.player.vx,s=this.player.vy;Math.hypot(a,s)<.01&&(a=(t.isKeyPressed("arrowright")||t.isKeyPressed("d")?1:0)-(t.isKeyPressed("arrowleft")||t.isKeyPressed("a")?1:0),s=(t.isKeyPressed("arrowdown")||t.isKeyPressed("s")?1:0)-(t.isKeyPressed("arrowup")||t.isKeyPressed("w")?1:0));const i=Math.hypot(a,s)||1;this.player.vx+=a/i*this.player.dashPower,this.player.vy+=s/i*this.player.dashPower,this.player.lastDashAt=e;for(let n=0;n<10;n++)this.player.trail.push({x:this.player.x,y:this.player.y,life:1})}update(t,e,a,s){const{ax:i,ay:n}=e.getMovementInput();if(i||n){const o=Math.hypot(i,n)||1;this.player.vx+=i/o*this.player.speed*(t*.06),this.player.vy+=n/o*this.player.speed*(t*.06)}this.player.vx*=.92,this.player.vy*=.92;const l=Math.hypot(this.player.vx,this.player.vy),c=this.player.maxSpeed+8;if(l>c){const o=c/l;this.player.vx*=o,this.player.vy*=o}this.player.x+=this.player.vx,this.player.y+=this.player.vy,this.player.x<this.player.r&&(this.player.x=this.player.r,this.player.vx*=-.4),this.player.x>a-this.player.r&&(this.player.x=a-this.player.r,this.player.vx*=-.4),this.player.y<this.player.r&&(this.player.y=this.player.r,this.player.vy*=-.4),this.player.y>s-this.player.r&&(this.player.y=s-this.player.r,this.player.vy*=-.4);for(let o=this.player.trail.length-1;o>=0;o--){const d=this.player.trail[o];d.life-=t*.003,d.life<=0&&this.player.trail.splice(o,1)}}resetPosition(t,e){this.player.x=t/2,this.player.y=e/2,this.player.vx=0,this.player.vy=0}resetMaxSpeed(){this.player.speed=this.initialData.speed}resetSize(){this.player.r=this.initialData.r}}class u{context;constructor(t){this.context=t}clear(t,e){this.context.clearRect(0,0,t,e)}drawGrid(t,e){this.context.globalAlpha=.45,this.context.lineWidth=1,this.context.strokeStyle="#1f2937";const a=40;for(let s=0;s<t;s+=a)this.context.beginPath(),this.context.moveTo(s,0),this.context.lineTo(s,e),this.context.stroke();for(let s=0;s<e;s+=a)this.context.beginPath(),this.context.moveTo(0,s),this.context.lineTo(t,s),this.context.stroke();this.context.globalAlpha=1}drawTargets(t){for(const e of t)this.context.fillStyle=e.color,this.context.beginPath(),this.context.arc(e.x,e.y,e.r,0,Math.PI*2),this.context.fill(),this.context.strokeStyle="rgba(249,115,22,0.35)",this.context.beginPath(),this.context.arc(e.x,e.y,e.r+6,0,Math.PI*2),this.context.stroke()}drawHazards(t){for(const e of t)this.context.fillStyle=e.color,this.context.beginPath(),this.context.arc(e.x,e.y,e.r,0,Math.PI*2),this.context.fill()}drawPlayer(t){for(const e of t.trail)this.context.globalAlpha=Math.max(e.life,0),this.context.fillStyle="#22d3ee",this.context.beginPath(),this.context.arc(e.x,e.y,6*e.life,0,Math.PI*2),this.context.fill();this.context.globalAlpha=1,this.context.shadowColor="#22d3ee",this.context.shadowBlur=18,this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.x,t.y,t.r,0,Math.PI*2),this.context.fill(),this.context.shadowBlur=0}drawParticles(t){for(const e of t)this.context.globalAlpha=Math.max(e.life,0),this.context.fillStyle="#ef4444",this.context.beginPath(),this.context.arc(e.x,e.y,e.r,0,Math.PI*2),this.context.fill();this.context.globalAlpha=1}}function v(r,t,e){return Math.max(t,Math.min(e,r))}class w{scoreEl;levelEl;coolbar;constructor(){this.scoreEl=document.getElementById("score"),this.levelEl=document.getElementById("level"),this.coolbar=document.getElementById("coolbar")}updateScore(t){this.scoreEl.textContent=String(t)}updateLevel(t){this.levelEl.textContent=String(t)}updateCooldown(t,e){const a=v((performance.now()-t)/e,0,1);this.coolbar.style.width=(a*100).toFixed(0)+"%"}}class m{canvasManager;entityManager;rendererManger;playerManager;uiManager;inputManager;score=0;level=1;lastTime=performance.now();constructor(t){this.canvasManager=new g(t),this.entityManager=new x(this.canvasManager.getWidth(),this.canvasManager.getHeight()),this.rendererManger=new u(this.canvasManager.context),this.playerManager=new M({x:this.canvasManager.getWidth()/2,y:this.canvasManager.getHeight()/2,vx:0,vy:0,r:12,color:"#22d3ee",speed:3.2,maxSpeed:5,dashPower:12,dashCooldownMs:700,lastDashAt:-9999,trail:[]}),this.uiManager=new w,this.inputManager=new f,this.inputManager.setDashCallback(()=>{this.playerManager.tryDash(this.inputManager)})}start(){for(let t=0;t<3;t++)this.entityManager.spawnTarget();this.loop()}loop(){const t=performance.now(),e=t-this.lastTime;this.lastTime=t,this.update(e),this.draw(),requestAnimationFrame(()=>this.loop())}update(t){this.playerManager.update(t,this.inputManager,this.canvasManager.getWidth(),this.canvasManager.getHeight()),this.entityManager.checkTargetCollisions(this.playerManager.player)&&(this.score+=1,this.uiManager.updateScore(this.score),this.score%5===0&&this.levelUp(),this.entityManager.spawnTarget()),this.entityManager.hazards.length<Math.min(3+Math.floor(this.level/2),10)&&Math.random()<.02&&this.entityManager.spawnHazard(),this.entityManager.updateHazards(),this.entityManager.checkHazardCollisions(this.playerManager.player)&&(this.entityManager.boom(this.playerManager.player.x,this.playerManager.player.y),this.resetGame()),this.entityManager.updateParticles(t),this.uiManager.updateCooldown(this.playerManager.player.lastDashAt,this.playerManager.player.dashCooldownMs)}levelUp(){this.level+=1,this.uiManager.updateLevel(this.level),this.playerManager.player.maxSpeed+=.2,this.playerManager.player.r+=1}resetGame(){this.score=0,this.level=1,this.entityManager.hazards.length=0,this.entityManager.targets.length=0,this.uiManager.updateScore(0),this.uiManager.updateLevel(1);for(let t=0;t<3;t++)this.entityManager.spawnTarget();this.playerManager.resetPosition(this.canvasManager.getWidth(),this.canvasManager.getHeight()),this.playerManager.resetMaxSpeed(),this.playerManager.resetSize()}draw(){const t=this.canvasManager.getWidth(),e=this.canvasManager.getHeight();this.rendererManger.clear(t,e),this.rendererManger.drawGrid(t,e),this.rendererManger.drawTargets(this.entityManager.targets),this.rendererManger.drawHazards(this.entityManager.hazards),this.rendererManger.drawPlayer(this.playerManager.player),this.rendererManger.drawParticles(this.entityManager.particles)}}function p(){try{const r=document.getElementById("root");if(!r)throw new Error("Canvas element with id 'root' not found in DOM");if(r.tagName!=="CANVAS")throw new Error("Element with id 'root' is not a canvas element");new m(r).start(),console.log("Game initialized successfully")}catch(r){console.error("Failed to initialize game:",r)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();
